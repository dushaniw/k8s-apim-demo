(this.webpackJsonp=this.webpackJsonp||[]).push([[32],{4715:function(e,a,t){"use strict";t.r(a);var r=t(1),s=t.n(r),n=t(317),o=t(34),d=t(21),i=t.n(d),l=t(1544),c=t.n(l),m=t(1516),p=t(4668),w=t(1744),g=t(1737),u=t(1702),f=t(1695),h=t(1708),P=t(69),E=t.n(P);const y=Object(g.a)(e=>({createTitle:{color:e.palette.getContrastText(e.palette.background.default)},formContent:{"& span, & div, & p, & input":{color:e.palette.getContrastText(e.palette.background.paper)}}}));function C(e){const{title:a,children:t}=e,r=y();return s.a.createElement(m.a,{width:1,mt:5},s.a.createElement(p.a,{justify:"center",container:!0,spacing:3},s.a.createElement(p.a,{item:!0,sm:6,md:4},s.a.createElement(p.a,{container:!0,spacing:4},s.a.createElement(p.a,{item:!0,md:12,className:r.createTitle},a),s.a.createElement(p.a,{item:!0,md:12,className:r.formContent},s.a.createElement(h.a,{elevation:0},t))))))}C.propTypes={title:E.a.element.isRequired,children:E.a.element.isRequired};var b=C,v=t(1534),x=t(318),M=t(1109),O=t(183),j=t(184);function S(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function T(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?S(Object(t),!0).forEach((function(a){k(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function k(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}const F=Object(g.a)(e=>({mandatoryStarText:{"& label>span:nth-child(1)":{color:"red"}},passwordChangeForm:{"& > span, & div, & p, & input":{color:e.palette.getContrastText(e.palette.primary.main)}}}));function N(e,a){let{field:t,value:r}=a;return T(T({},e),{},{[t]:r})}a.default=()=>{const{settings:{IsPasswordChangeEnabled:e,userStorePasswordPattern:a,passwordPolicyPattern:t,passwordPolicyMinLength:d,passwordPolicyMaxLength:l}}=Object(j.d)(),g=F(),h=o.a.getUser().name,P={currentPassword:void 0,newPassword:void 0,repeatedNewPassword:void 0},[E,y]=Object(r.useReducer)(N,P),{currentPassword:C,newPassword:S,repeatedNewPassword:T}=E,k=i.a.passwordChange.guidelinesEnabled;let q=[];k&&(q=i.a.passwordChange.policyList);const R=()=>{let e=c.a.string().empty();d&&-1!==d&&(e=e.min(d)),l&&-1!==l&&(e=e.max(l));const r=e.validate(S).error;if(r){const e=r.details[0].type;if("string.empty"===e)return s.a.createElement(n.a,{id:"Change.Password.password.empty",defaultMessage:"Password is empty"});if("string.min"===e)return s.a.createElement(n.a,{id:"Change.Password.password.length.short",defaultMessage:"Password is too short!"});if("string.max"===e)return s.a.createElement(n.a,{id:"Change.Password.password.length.long",defaultMessage:"Password is too long!"})}if(a){const e=c.a.string().pattern(new RegExp(a)).validate(S).error;if(e){if("string.pattern.base"===e.details[0].type)return s.a.createElement(n.a,{id:"Change.Password.password.pattern.invalid",defaultMessage:"Invalid password pattern"})}}if(t){const e=c.a.string().pattern(new RegExp(t)).validate(S).error;if(e){if("string.pattern.base"===e.details[0].type)return s.a.createElement(n.a,{id:"Change.Password.password.pattern.invalid",defaultMessage:"Invalid password pattern"})}}return!1},D=()=>{if(T&&S!==T)return s.a.createElement(n.a,{id:"Change.Password.password.mismatch",defaultMessage:"Password doesn't match"})},I=e=>{let{target:{name:a,value:t}}=e;y({field:a,value:t})},B=()=>{if(!T||S===T){return(new x.a).changePassword(C,S).then(e=>{M.a.success(s.a.createElement(n.a,{id:"Change.Password.password.changed.success",defaultMessage:"User password changed successfully. Please use the new password on next sign in"})),window.history.back()}).catch(e=>{switch(e.response.body.code){case 901450:M.a.error(s.a.createElement(n.a,{id:"Change.Password.password.change.disabled",defaultMessage:"Password change disabled"}));break;case 901451:M.a.error(s.a.createElement(n.a,{id:"Change.Password.current.password.incorrect",defaultMessage:"Current password is incorrect"}));break;case 901452:M.a.error(s.a.createElement(n.a,{id:"Change.Password.password.pattern.invalid",defaultMessage:"Invalid password pattern"}))}})}M.a.error(s.a.createElement(n.a,{id:"Change.Password.password.mismatch",defaultMessage:"Password doesn't match"}))},L=s.a.createElement(s.a.Fragment,null,s.a.createElement(f.a,{variant:"h5",component:"h1"},s.a.createElement(n.a,{id:"Change.Password.title",defaultMessage:"Change Password"}),": "+h),s.a.createElement(f.a,{variant:"caption"},s.a.createElement(n.a,{id:"Change.Password.description",defaultMessage:"Change your own password. Required fields are marked with an asterisk ( * )"})),k&&q.length>0?s.a.createElement(f.a,{variant:"body2"},s.a.createElement(n.a,{id:"Change.Password.password.policy",defaultMessage:"Password policy:"}),s.a.createElement("ul",{style:{marginTop:"-4px",marginBottom:"-8px"}},q.map(e=>s.a.createElement("li",null,e)))):null);return void 0===e?s.a.createElement(O.a,null):e?s.a.createElement(b,{title:L},s.a.createElement(m.a,{py:2,display:"flex",justifyContent:"center"},s.a.createElement(p.a,{item:!0,xs:10,md:9},s.a.createElement(m.a,{component:"div",m:2},s.a.createElement(p.a,{container:!0,mt:2,spacing:2,direction:"column",justify:"center",alignItems:"flex-start"},s.a.createElement(u.a,{classes:{root:g.mandatoryStarText},required:!0,id:"current-password",autoFocus:!0,margin:"dense",name:"currentPassword",value:C,onChange:I,label:s.a.createElement(n.a,{id:"Settings.ChangePasswordForm.current.password",defaultMessage:"Current Password"}),fullWidth:!0,error:""===C,helperText:s.a.createElement(n.a,{id:"Settings.ChangePasswordForm.enter.current.password",defaultMessage:"Enter Current Password"}),variant:"outlined",type:"password"}),s.a.createElement(u.a,{classes:{root:g.mandatoryStarText},margin:"dense",id:"new-password",name:"newPassword",value:S,onChange:I,label:s.a.createElement(n.a,{id:"Settings.ChangePasswordForm.new.password",defaultMessage:"New Password"}),required:!0,fullWidth:!0,error:R(),helperText:R()||s.a.createElement(n.a,{id:"Settings.ChangePasswordForm.enter.new.password",defaultMessage:"Enter a New Password"}),variant:"outlined",type:"password"}),s.a.createElement(u.a,{classes:{root:g.mandatoryStarText},margin:"dense",id:"repeated-new-password",name:"repeatedNewPassword",value:T,onChange:I,label:s.a.createElement(n.a,{id:"Settings.ChangePasswordForm.confirm.new.password",defaultMessage:"Confirm new Password"}),required:!0,fullWidth:!0,error:D(),helperText:D()||s.a.createElement(n.a,{id:"Settings.ChangePasswordForm.confirmationOf.new.password",defaultMessage:"Confirmation of new Password"}),variant:"outlined",type:"password"}),s.a.createElement(m.a,{my:2,display:"flex",flexDirection:"row"},s.a.createElement(m.a,{mr:1},s.a.createElement(w.a,{color:"primary",variant:"contained",onClick:B,className:g.passwordChangeForm},s.a.createElement(n.a,{id:"Settings.ChangePasswordForm.Save.Button.text",defaultMessage:"Save"}))),s.a.createElement(m.a,{mx:1},s.a.createElement(w.a,{onClick:()=>window.history.back()},s.a.createElement(n.a,{id:"Settings.ChangePasswordForm.Cancel.Button.text",defaultMessage:"Cancel"}))))))))):s.a.createElement(v.a,null)}}}]);
//# sourceMappingURL=32.d7d45bfaabce8b993e4f.bundle.js.map